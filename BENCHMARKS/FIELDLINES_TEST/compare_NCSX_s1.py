#!/usr/bin/env python3
import sys, os
sys.path.insert(0, '../../pySTEL/')
import numpy as np                    #For Arrays
from math import pi
from libstell.fieldlines import read_fieldlines, calc_iota

try:
	qtCreatorPath=os.environ["STELLOPT_PATH"]
except KeyError:
	print("Please set environment variable STELLOPT_PATH")
	sys.exit(1)
failtol = 1.0
filename='fieldlines_NCSX_s1.h5'
data=read_fieldlines(filename)
if not data:
    print('ERROR Opening File: '+filename)
    sys.exit(0)
else:
    print('EXTENSION: '+filename)
print('==== Scalars ====')
varlist={}
varlist['iota0']=0.2953595750052106
lfail = 0;
for temp in varlist:
    act = varlist[temp]
    cal = data[temp]
    perct = 100*(abs(act-cal)/act)
    print('  '+temp+': '+str(cal)+'   '+str(act)+'   '+str(int(perct))+'%')
    if perct > failtol:
        lfail = 1        
print('==== Vectors ====')
varlist={}
iota_data = calc_iota(data)
varlist['iota']=np.array([[ 0.14018862], [ 0.1405419 ], [ 0.14089518], [ 0.14146037], [0.14251876], [ 0.14398264], [ 0.14582902], [ 0.14788358], \
 [0.15002786], [ 0.1523993 ], [ 0.154785  ], [ 0.15717504], [0.15968754], [ 0.16216067], [ 0.1646967 ], [ 0.1671161 ], \
 [0.16968349], [ 0.17208011], [ 0.17447306], [ 0.17686855], [0.17920198], [ 0.18148378], [ 0.18375362], [ 0.18597824], \
 [0.18793333], [ 0.19021549], [ 0.19230822], [ 0.19435355], [0.19634761], [ 0.1983217 ], [ 0.199992  ], [ 0.20207096], \
 [0.20388092], [ 0.20570541], [ 0.20744672], [ 0.20916366], [0.21089245], [ 0.21254412], [ 0.21429243], [ 0.21565329], \
 [0.21723609], [ 0.21877294], [ 0.22022564], [ 0.22168049], [0.22307697], [ 0.22447065], [ 0.22584008], [ 0.22718836], \
 [0.22850251], [ 0.22982753], [ 0.2307531 ], [ 0.23225573], [0.23349887], [ 0.23470675], [ 0.23588253], [ 0.23702374], \
 [0.23814263], [ 0.23922661], [ 0.24040359], [ 0.24144835], [0.24248898], [ 0.24345146], [ 0.2445022 ], [ 0.24551991], \
 [0.24652023], [ 0.2474835 ], [ 0.248511  ], [ 0.25000793], [0.24999921], [ 0.25086518], [ 0.25190757], [ 0.25283443], \
 [0.25372666], [ 0.25461038], [ 0.25547419], [ 0.25632857], [0.25714207], [ 0.25798054], [ 0.25883837], [ 0.25964557], \
 [0.26049643], [ 0.26086297], [ 0.26197147], [ 0.26277447], [0.26358034], [ 0.26437371], [ 0.2650037 ], [ 0.26575691], \
 [0.26655808], [ 0.26732669], [ 0.26805694], [ 0.26865635], [0.26950933], [ 0.27020881], [ 0.27086955], [ 0.27153261], \
 [0.27316181], [ 0.27368398], [ 0.27435917], [ 0.27499967], [0.27567564], [ 0.27631521], [ 0.27710839], [ 0.27777729], \
 [0.27847746], [ 0.27933393], [ 0.27999966], [ 0.28077406], [0.28124918], [ 0.28204508], [ 0.28282714], [ 0.28359388], \
 [0.28437538], [ 0.28572164], [ 0.28571422], [ 0.28570823], [0.28708166], [ 0.28787838], [ 0.28870789], [ 0.28942211], \
 [0.29032239], [ 0.29076937], [ 0.29149768], [ 0.29241877], [0.29296466], [ 0.29421991], [-0.07873187], [-0.13739811]])
for temp in varlist:
    act = np.squeeze(varlist[temp])
    cal = iota_data[temp]
    perct = 100*sum(abs(act-cal)/act)
    print('  '+temp+': '+str(cal[64])+'   '+str(act[64])+'   '+str(int(perct))+'%')
    if perct > failtol:
        lfail = 1
print('==== Arrays =====')
varlist={}
varlist['R_lines']=np.array([[1.56479379,1.56548724,1.56618068,1.56687413,1.56756757,1.56826102,1.56895446,1.56964791,1.57034135,1.5710348 ,1.57172824,1.57242169, \
 1.57311513,1.57380858,1.57450202,1.57519547,1.57588891,1.57658236,1.5772758 ,1.57796925,1.57866269,1.57935614,1.58004958,1.58074303, \
 1.58143647,1.58212992,1.58282336,1.58351681,1.58421025,1.5849037 ,1.58559714,1.58629059,1.58698403,1.58767748,1.58837092,1.58906437, \
 1.58975781,1.59045126,1.5911447 ,1.59183815,1.59253159,1.59322504,1.59391848,1.59461193,1.59530537,1.59599882,1.59669226,1.59738571, \
 1.59807915,1.5987726 ,1.59946604,1.60015949,1.60085293,1.60154638,1.60223982,1.60293327,1.60362671,1.60432016,1.6050136 ,1.60570705, \
 1.60640049,1.60709394,1.60778738,1.60848083,1.60917427,1.60986772,1.61056116,1.61125461,1.61194805,1.6126415 ,1.61333494,1.61402839, \
 1.61472183,1.61541528,1.61610872,1.61680217,1.61749561,1.61818906,1.6188825 ,1.61957595,1.62026939,1.62096284,1.62165628,1.62234973, \
 1.62304317,1.62373662,1.62443006,1.62512351,1.62581695,1.6265104 ,1.62720384,1.62789729,1.62859073,1.62928418,1.62997762,1.63067107, \
 1.63136451,1.63205796,1.6327514 ,1.63344485,1.63413829,1.63483174,1.63552518,1.63621863,1.63691207,1.63760552,1.63829896,1.63899241, \
 1.63968585,1.6403793 ,1.64107274,1.64176619,1.64245963,1.64315308,1.64384652,1.64453997,1.64523341,1.64592686,1.6466203 ,1.64731375, \
 1.64800719,1.64870064,1.64939408,1.65008753,1.65078097,1.65147442,1.65216786,1.65286131], \
 [1.519623  ,1.52043455,1.52124564,1.52205628,1.52286647,1.52367621,1.5244855 ,1.52529433,1.52610273,1.52691069,1.52771819,1.52852529, \
 1.52933197,1.53013826,1.53094415,1.53174963,1.53255475,1.53335948,1.53416381,1.53496777,1.53577135,1.53657453,1.53737731,1.5381797 , \
 1.53898168,1.53978324,1.54058441,1.54138515,1.54218549,1.54298542,1.54378496,1.54458406,1.5453828 ,1.54618113,1.5469791 ,1.54777671, \
 1.54857394,1.54937082,1.55016732,1.55096349,1.55175932,1.55255478,1.55334988,1.55414462,1.55493901,1.55573303,1.55652668,1.55731996, \
 1.55811285,1.55890537,1.5596975 ,1.56048926,1.56128064,1.56207168,1.56286232,1.56365263,1.56444258,1.56523219,1.56602147,1.56681042, \
 1.56759904,1.56838733,1.56917531,1.56996297,1.5707503 ,1.57153731,1.57232396,1.57311029,1.57389628,1.57468191,1.57546719,1.57625212, \
 1.57703669,1.57782091,1.57860479,1.57938835,1.58017155,1.58095443,1.58173699,1.58251922,1.58330116,1.58408279,1.58486412,1.58564516, \
 1.5864259 ,1.58720635,1.5879865 ,1.58876634,1.58954586,1.59032507,1.59110396,1.59188253,1.59266075,1.59343864,1.5942162 ,1.59499346, \
 1.59577037,1.59654698,1.59732328,1.59809927,1.59887496,1.59965036,1.60042548,1.60120033,1.60197489,1.60274919,1.60352322,1.60429697, \
 1.60507044,1.60584362,1.60661651,1.60738909,1.60816137,1.60893335,1.60970501,1.61047635,1.61124739,1.61201812,1.61278855,1.61355869, \
 1.61432855,1.61509812,1.61586741,1.61663644,1.61740521,1.61817372,1.61894198,1.61970999], \
 [1.31119373,1.30975236,1.30830964,1.30687529,1.30546905,1.30411376,1.30281723,1.30159503,1.30044206,1.29938743,1.29844967,1.29761775, \
 1.29695056,1.29649436,1.29625812,1.29627424,1.29658118,1.29717818,1.29806602,1.29929191,1.30085632,1.30272127,1.30487971,1.30730142, \
 1.30999457,1.31290261,1.31600497,1.31928328,1.32269982,1.32620453,1.32976613,1.33335348,1.33695304,1.34054833,1.3441201 ,1.34765227, \
 1.35113432,1.35454221,1.35787436,1.36112605,1.36427033,1.36731596,1.37025872,1.37309827,1.37585234,1.37851806,1.38108829,1.38358221, \
 1.3859596 ,1.38826008,1.39047959,1.39260427,1.39463993,1.39660233,1.39848397,1.40027879,1.40201149,1.40368325,1.40528315,1.40680085, \
 1.40823771,1.40959453,1.41088962,1.41211318,1.41327529,1.41437755,1.41542039,1.41637679,1.41724187,1.41802006,1.41869839,1.41928984, \
 1.41980506,1.4202465 ,1.42059977,1.42085725,1.42102573,1.42111293,1.42111764,1.42102334,1.42080534,1.42046309,1.42002246,1.41947277, \
 1.41881289,1.41804651,1.41717108,1.41619537,1.41509745,1.41387028,1.41250931,1.41101145,1.40937111,1.40759448,1.40568569,1.40363879, \
 1.40144349,1.39909568,1.39661073,1.39400118,1.39126479,1.38837436,1.38531555,1.3821031 ,1.37873045,1.37520486,1.37152988,1.36768256, \
 1.36367645,1.35950601,1.35512842,1.35057641,1.34589004,1.34100651,1.3358637 ,1.33045164,1.32470368,1.31867392,1.31242068,1.30583853, \
 1.29893319,1.29159072,1.28359424,1.27501358,1.26570903,1.25558547,1.24464655,1.23273304], \
 [1.56479379,1.56512509,1.56541734,1.56590427,1.56702142,1.56826089,1.56742059,1.56237668,1.55549269,1.55351789,1.55698238,1.55619012, \
 1.54708889,1.54444855,1.55885552,1.57387487,1.5705082 ,1.54805701,1.5284618 ,1.53434568,1.54990709,1.54508672,1.5218876 ,1.51531587, \
 1.53849017,1.57146093,1.58251401,1.56360933,1.52495365,1.49489701,1.49908751,1.52749968,1.54410047,1.52827096,1.49310589,1.47369702, \
 1.49138163,1.53315119,1.57226481,1.59108979,1.58362406,1.55025393,1.50274918,1.46048431,1.44385084,1.46012938,1.49741151,1.52910561, \
 1.53226983,1.50262662,1.45916879,1.42597759,1.41953625,1.44327197,1.48643671,1.53479752,1.57470279,1.59896613,1.6037444 ,1.58743454, \
 1.55308081,1.50779294,1.45507229,1.40916941,1.38016848,1.37549933,1.39868832,1.43933028,1.47036062,1.5032115 ,1.52273937,1.50989049, \
 1.47227097,1.420294  ,1.3745178 ,1.34515215,1.33728836,1.35049705,1.38634205,1.43123745,1.48437452,1.52912936,1.57131092,1.60264214, \
 1.62067745,1.62201575,1.61099427,1.58279569,1.5425112 ,1.4919418 ,1.43581947,1.3837689 ,1.33204031,1.29318216,1.27585363,1.27831704, \
 1.30830403,1.37132186,1.44074324,1.47975393,1.50413496,1.50351103,1.47245031,1.41579353,1.35242624,1.29043415,1.25221418,1.22844275, \
 1.23081665,1.25642846,1.3098978 ,1.37284102,1.44525203,1.52845014,1.56053881,1.58544456,1.63063578,1.64580752,1.6388123 ,1.61342184, \
 1.5645295 ,1.53307117,1.46197017,1.34730229,1.30972083,1.23106748,1.16042066,1.48825615], \
 [1.56479401,1.56413036,1.56383213,1.56656545,1.56160981,1.56825037,1.55975439,1.55785742,1.55929387,1.558684  ,1.55801377,1.55733304, \
 1.55583153,1.5531361 ,1.54575333,1.54261174,1.53403754,1.53122883,1.52833474,1.52549615,1.52536076,1.53261897,1.54339847,1.54953304, \
 1.51023203,1.50826227,1.551126  ,1.58275444,1.52199047,1.50972852,1.50015522,1.51122154,1.58026853,1.48020388,1.53026624,1.53064479, \
 1.54424555,1.52818304,1.46396724,1.53033525,1.53847023,1.52074664,1.46175802,1.47322856,1.58536634,1.53206436,1.55921223,1.4459823 , \
 1.46457102,1.44185646,1.52486342,1.44512327,1.41687014,1.45552882,1.41047687,1.42349053,1.43180457,1.40628818,1.4860768 ,1.46029262, \
 1.59961281,1.49757274,1.52903489,1.37988995,1.37683233,1.53648259,1.50676709,1.44269994,1.47835715,1.51567323,1.60398044,1.3753557 , \
 1.35111579,1.56953887,1.48951392,1.41612782,1.49480111,1.51815733,1.47831642,1.42854595,1.4984556 ,1.32021978,1.47317011,1.51492128, \
 1.43178222,1.46631477,1.43129997,1.30756693,1.59334265,1.37119065,1.29220263,1.60100421,1.28183269,1.41588301,1.48429885,1.49300051, \
 1.30784706,1.62593264,1.26022129,1.40494464,1.49033833,1.49676576,1.48248822,1.26408252,1.63029982,1.33114739,1.25187624,1.63745096, \
 1.36619037,1.50061522,1.43106733,1.42677742,1.49614556,1.63212405,1.62085688,1.61804228,1.29741162,1.61972056,1.19070798,1.34745784, \
 1.6415503 ,1.45213051,1.46853344,1.41597709,1.61583772,1.38027756,1.33104693,0.        ], \
 [1.56479358,1.56522884,1.56344268,1.56573785,1.56261645,1.56822054,1.56061182,1.55809786,1.56976262,1.57103368,1.57164367,1.57215426, \
 1.5690399 ,1.56044525,1.54138553,1.53759274,1.5459057 ,1.54391643,1.54136202,1.53870432,1.52586287,1.52332538,1.55487006,1.58021452, \
 1.52922362,1.54801922,1.5054205 ,1.58035819,1.51610991,1.4942783 ,1.49591925,1.51647217,1.56217453,1.52515342,1.54682286,1.47452549, \
 1.47426523,1.54908163,1.52355545,1.46032813,1.5894509 ,1.45570722,1.53613761,1.44954446,1.5577756 ,1.58240837,1.47625912,1.43961496, \
 1.50053842,1.53126104,1.42440177,1.51872438,1.49343047,1.48568001,1.50124208,1.52810488,1.51388652,1.42571928,1.40882147,1.44089666, \
 1.57857168,1.53176356,1.39754501,1.45469831,1.48820308,1.39883434,1.56285211,1.37174665,1.37674888,1.5967084 ,1.57827966,1.35456646, \
 1.48252081,1.45299953,1.54727535,1.41776157,1.33725303,1.61617248,1.32989613,1.37599589,1.57803594,1.43040108,1.3179744 ,1.6191686 , \
 1.33875206,1.30796996,1.45031801,1.49877501,1.50433404,1.34263181,1.35885054,1.53082911,1.40681061,1.42248655,1.27896016,1.2758296 , \
 1.49698301,1.58236488,1.31954505,1.42530176,1.26204008,1.26425714,1.58397585,1.50073947,1.60085185,1.30590164,1.2521223 ,1.63475008, \
 1.30219243,1.6293574 ,1.22288768,1.22985515,1.63690376,1.58266029,1.55910886,1.56682895,1.26492166,1.55059536,1.35032953,1.35952491, \
 1.60013364,1.18119429,1.57376368,1.18177535,1.50280208,1.53674062,0.        ,0.        ]])
varlist['Z_lines']=np.array([[4.03047683e-07,3.99874080e-07,3.96700476e-07,3.93526872e-07,3.90353268e-07,3.87179664e-07,3.84006061e-07,3.80832457e-07, \
 3.77658853e-07,3.74485249e-07,3.71311645e-07,3.68138042e-07,3.64964438e-07,3.61790834e-07,3.58617230e-07,3.55443626e-07, \
 3.52270023e-07,3.49096419e-07,3.45922815e-07,3.42749211e-07,3.39575607e-07,3.36402003e-07,3.33228400e-07,3.30054796e-07, \
 3.26881192e-07,3.23707588e-07,3.20533984e-07,3.17360381e-07,3.14186777e-07,3.11013173e-07,3.07839569e-07,3.04665965e-07, \
 3.01492362e-07,2.98318758e-07,2.95145154e-07,2.91971550e-07,2.88797946e-07,2.85624343e-07,2.82450739e-07,2.79277135e-07, \
 2.76103531e-07,2.72929927e-07,2.69756324e-07,2.66582720e-07,2.63409116e-07,2.60235512e-07,2.57061908e-07,2.53888305e-07, \
 2.50714701e-07,2.47541097e-07,2.44367493e-07,2.41193889e-07,2.38020285e-07,2.34846682e-07,2.31673078e-07,2.28499474e-07, \
 2.25325870e-07,2.22152266e-07,2.18978663e-07,2.15805059e-07,2.12631455e-07,2.09457851e-07,2.06284247e-07,2.03110644e-07, \
 1.99937040e-07,1.96763436e-07,1.93589832e-07,1.90416228e-07,1.87242625e-07,1.84069021e-07,1.80895417e-07,1.77721813e-07, \
 1.74548209e-07,1.71374606e-07,1.68201002e-07,1.65027398e-07,1.61853794e-07,1.58680190e-07,1.55506587e-07,1.52332983e-07, \
 1.49159379e-07,1.45985775e-07,1.42812171e-07,1.39638567e-07,1.36464964e-07,1.33291360e-07,1.30117756e-07,1.26944152e-07, \
 1.23770548e-07,1.20596945e-07,1.17423341e-07,1.14249737e-07,1.11076133e-07,1.07902529e-07,1.04728926e-07,1.01555322e-07, \
 9.83817180e-08,9.52081142e-08,9.20345104e-08,8.88609066e-08,8.56873028e-08,8.25136990e-08,7.93400952e-08,7.61664914e-08, \
 7.29928875e-08,6.98192837e-08,6.66456799e-08,6.34720761e-08,6.02984723e-08,5.71248685e-08,5.39512647e-08,5.07776609e-08, \
 4.76040571e-08,4.44304533e-08,4.12568495e-08,3.80832457e-08,3.49096419e-08,3.17360381e-08,2.85624343e-08,2.53888305e-08, \
 2.22152266e-08,1.90416228e-08,1.58680190e-08,1.26944152e-08,9.52081142e-09,6.34720761e-09,3.17360381e-09,0.00000000e+00], \
 [0.05764529,0.05757418,0.057503  ,0.05743174,0.05736042,0.05728902,0.05721756,0.05714604,0.05707446,0.0570028 ,0.05693106,0.05685926, \
 0.05678737,0.0567154 ,0.05664335,0.05657123,0.05649903,0.05642675,0.0563544 ,0.05628197,0.05620948,0.05613692,0.05606429,0.0559916 , \
 0.05591885,0.05584604,0.05577318,0.05570027,0.0556273 ,0.05555427,0.0554812 ,0.05540807,0.05533488,0.05526163,0.05518832,0.05511495, \
 0.05504151,0.05496802,0.05489446,0.05482083,0.05474715,0.05467341,0.05459961,0.05452576,0.05445185,0.0543779 ,0.0543039 ,0.05422986, \
 0.05415577,0.05408164,0.05400746,0.05393324,0.05385898,0.05378467,0.05371032,0.05363592,0.05356147,0.05348698,0.05341244,0.05333785, \
 0.05326321,0.05318853,0.05311379,0.05303902,0.05296419,0.05288933,0.05281442,0.05273946,0.05266447,0.05258944,0.05251437,0.05243926, \
 0.05236411,0.05228893,0.05221372,0.05213847,0.05206319,0.05198787,0.05191251,0.05183712,0.05176169,0.05168623,0.05161074,0.05153521, \
 0.05145964,0.05138403,0.05130839,0.0512327 ,0.05115698,0.05108122,0.05100543,0.0509296 ,0.05085374,0.05077785,0.05070193,0.05062597, \
 0.05054999,0.05047398,0.05039795,0.05032188,0.05024579,0.05016967,0.05009353,0.05001736,0.04994117,0.04986495,0.0497887 ,0.04971241, \
 0.0496361 ,0.04955975,0.04948336,0.04940694,0.04933049,0.04925401,0.0491775 ,0.04910096,0.0490244 ,0.04894781,0.0488712 ,0.04879457, \
 0.04871791,0.04864123,0.04856452,0.0484878 ,0.04841106,0.0483343 ,0.04825752,0.04818072], \
 [ 6.72736994e-07,-2.84962781e-03,-5.76868549e-03,-8.83055713e-03,-1.22071971e-02,-1.59643229e-02,-2.02036205e-02,-2.48246649e-02, \
 -2.98023196e-02,-3.50023396e-02,-4.04588828e-02,-4.60373349e-02,-5.16779843e-02,-5.72770851e-02,-6.27706087e-02,-6.81221454e-02, \
 -7.31914936e-02,-7.79370112e-02,-8.23694439e-02,-8.63909752e-02,-8.99734788e-02,-9.31472022e-02,-9.57963262e-02,-9.79607953e-02, \
 -9.96450328e-02,-1.00887124e-01,-1.01654199e-01,-1.02000542e-01,-1.01890154e-01,-1.01412835e-01,-1.00532171e-01,-9.93028580e-02, \
 -9.77539900e-02,-9.59169334e-02,-9.38006334e-02,-9.13905912e-02,-8.87549012e-02,-8.58830127e-02,-8.27943451e-02,-7.95253054e-02, \
 -7.60936138e-02,-7.25268143e-02,-6.88418320e-02,-6.50336881e-02,-6.11065487e-02,-5.70692302e-02,-5.29381476e-02,-4.87151071e-02, \
 -4.43970135e-02,-3.99839026e-02,-3.54950759e-02,-3.09595253e-02,-2.63928675e-02,-2.18092602e-02,-1.72108104e-02,-1.25895960e-02, \
 -7.92943904e-03,-3.23617559e-03, 1.47727993e-03, 6.22572364e-03, 1.09909213e-02, 1.57598270e-02, 2.05318653e-02, 2.52976845e-02, \
  3.00638391e-02, 3.48206408e-02, 3.95848365e-02, 4.43673449e-02, 4.91729394e-02, 5.39775301e-02, 5.87556417e-02, 6.35108736e-02, \
  6.82755244e-02, 7.30347138e-02, 7.77793681e-02, 8.25073400e-02, 8.72306220e-02, 9.19608484e-02, 9.66991436e-02, 1.01441572e-01, \
  1.06153815e-01, 1.10843623e-01, 1.15551885e-01, 1.20225746e-01, 1.24891782e-01, 1.29541020e-01, 1.34167822e-01, 1.38812172e-01, \
  1.43426784e-01, 1.48001041e-01, 1.52537530e-01, 1.57005557e-01, 1.61440564e-01, 1.65827955e-01, 1.70136201e-01, 1.74407018e-01, \
  1.78687531e-01, 1.82946136e-01, 1.87120623e-01, 1.91228849e-01, 1.95263277e-01, 1.99259152e-01, 2.03250012e-01, 2.07187214e-01, \
  2.11079105e-01, 2.14904072e-01, 2.18646479e-01, 2.22321515e-01, 2.25923582e-01, 2.29490633e-01, 2.33057461e-01, 2.36572600e-01, \
  2.39995539e-01, 2.43385532e-01, 2.46787024e-01, 2.50227053e-01, 2.53743466e-01, 2.57269393e-01, 2.60744844e-01, 2.64243944e-01, \
  2.67750859e-01, 2.71333999e-01, 2.75095352e-01, 2.78965527e-01, 2.83039583e-01, 2.87325943e-01, 2.91760042e-01, 2.96353039e-01], \
 [ 4.28252412e-06,-1.11223182e-02,-2.04469294e-02,-2.58837736e-02,-2.09079110e-02,-3.19984285e-04, 3.72308894e-02, 7.97151975e-02, \
  1.06638132e-01, 9.60152422e-02, 4.02419809e-02,-4.24205483e-02,-1.24897800e-01,-1.60891291e-01,-1.26909009e-01,-3.76928483e-02, \
  7.68696258e-02, 1.70678503e-01, 2.06128278e-01, 1.59222789e-01, 4.68412804e-02,-8.83583369e-02,-2.01283157e-01,-2.46581101e-01, \
 -2.13408230e-01,-1.11011295e-01, 1.90696458e-02, 1.51078199e-01, 2.49946070e-01, 2.87428342e-01, 2.51267964e-01, 1.48461304e-01, \
  7.24693416e-03,-1.38908315e-01,-2.56163172e-01,-3.18742096e-01,-3.16185901e-01,-2.54018709e-01,-1.50715448e-01,-3.02552393e-02, \
  1.04491803e-01, 2.24469061e-01, 3.14399311e-01, 3.61697642e-01, 3.60614553e-01, 3.11075888e-01, 2.16705481e-01, 8.68920402e-02, \
 -5.52052132e-02,-1.94998854e-01,-3.02222180e-01,-3.72084643e-01,-4.04565969e-01,-3.98597849e-01,-3.57034901e-01,-2.84326012e-01, \
 -1.89976263e-01,-8.29165861e-02, 4.18673898e-02, 1.52591738e-01, 2.55646851e-01, 3.39045150e-01, 4.04240092e-01, 4.41527672e-01, \
  4.51219958e-01, 4.34517269e-01, 3.85885089e-01, 3.12604010e-01, 2.48490321e-01, 1.53754189e-01, 1.34031839e-02,-1.20354545e-01, \
 -2.37848543e-01,-3.38798275e-01,-4.10519736e-01,-4.58845857e-01,-4.85940671e-01,-4.94454612e-01,-4.81367113e-01,-4.50708737e-01, \
 -3.97654037e-01,-3.35642103e-01,-2.54679198e-01,-1.60895486e-01,-5.59734058e-02, 4.86021683e-02, 1.32425131e-01, 2.35253470e-01, \
  3.23839624e-01, 3.99721757e-01, 4.60878533e-01, 5.01493266e-01, 5.28331584e-01, 5.39602244e-01, 5.36088300e-01, 5.17478644e-01, \
  4.65587116e-01, 3.80910770e-01, 2.71572774e-01, 1.78157682e-01, 6.20970178e-02,-6.39831810e-02,-1.94994474e-01,-3.10643489e-01, \
 -3.99139704e-01,-4.72856862e-01,-5.19034690e-01,-5.56169990e-01,-5.68924037e-01,-5.74959289e-01,-5.62859612e-01,-5.32299035e-01, \
 -4.77202149e-01,-3.83171117e-01,-3.31322666e-01,-2.80002372e-01,-1.38016910e-01,-1.44583543e-02, 9.93901226e-02, 2.11767295e-01, \
  3.33661806e-01, 3.85184627e-01, 4.69159034e-01, 5.59645402e-01, 5.78716615e-01, 5.95909345e-01, 5.92584354e-01, 8.20628627e-02], \
 [ 5.08511687e-06,-5.18601845e-03,-2.71874568e-02,-1.49004189e-02, 3.75337909e-02,-3.05695948e-03,-8.18311497e-02,-6.42346300e-02, \
 -1.06059113e-02,-4.12353820e-04, 3.91836009e-03, 7.79434206e-03,-3.58322375e-02,-6.52920622e-02,-1.20261984e-01,-1.34894930e-01, \
 -1.82388995e-01,-1.90088072e-01,-1.97806528e-01,-2.04670256e-01,-1.96580829e-01,-1.59079896e-01,-9.57142625e-02, 1.28135716e-02, \
  2.41387731e-01, 2.61043530e-01, 1.87762552e-01,-3.01823499e-02,-2.54942859e-01,-2.19898649e-01, 2.48019414e-01, 2.78934202e-01, \
 -8.96909078e-02,-3.05731526e-01, 1.26203462e-01, 2.54815653e-01,-2.28258055e-01,-1.26926487e-01, 3.37802327e-01,-2.63475817e-01, \
 -3.36383035e-02, 2.84635227e-01,-3.57807945e-01, 2.85052545e-01,-1.10884523e-01,-7.33854854e-02, 2.12225852e-01,-3.38221546e-01, \
  3.70372253e-01,-3.89854356e-01, 2.93586811e-01,-3.92769486e-01, 3.98631948e-01,-3.88475993e-01, 4.09573562e-01,-4.15434633e-01, \
  4.13071837e-01,-3.95323034e-01, 3.63931728e-01,-2.83873130e-01, 9.38332413e-02, 1.87425370e-01,-3.06632120e-01, 4.36898151e-01, \
 -4.47585687e-01, 2.98232813e-01,-1.44666174e-01, 4.24574299e-01, 3.87867503e-01,-9.59319145e-02,-1.09106180e-01, 4.15299923e-01, \
 -4.73605808e-01, 2.41565763e-01, 1.89039874e-01,-4.56958352e-01, 3.78836594e-01, 3.62733997e-02,-4.02090027e-01, 4.52994531e-01, \
 -1.47685023e-01,-4.98232345e-01, 4.13099564e-01, 3.91603257e-02,-4.56877809e-01, 4.24707322e-01, 3.03308563e-01,-5.23400853e-01, \
  2.06899469e-01, 3.92526094e-01,-5.07169276e-01,-1.88273585e-01, 5.26303731e-01,-3.21935967e-01,-4.14574812e-01, 4.04762501e-01, \
 -4.65013423e-01, 9.59770968e-02, 5.29444792e-01,-3.31332478e-01,-4.16773720e-01, 4.09790959e-01, 1.64738647e-01,-5.63267705e-01, \
  9.49820549e-02, 4.24072142e-01,-5.19450274e-01,-4.92980735e-02, 5.32835732e-01,-5.60843145e-02,-4.87962290e-01, 4.92721466e-01, \
  8.11604675e-02, 1.22083720e-01, 1.75058535e-01, 1.83656517e-01,-4.50339878e-01,-1.86214657e-01, 5.83048268e-01,-3.90326004e-01, \
 -8.88634594e-02, 4.78117857e-01, 1.82812870e-01,-5.11312786e-01, 2.10275451e-01, 3.46435604e-01,-5.80003734e-01, 0.00000000e+00], \
 [-2.03407063e-07, 9.60087266e-03, 1.46919747e-02,-2.78704934e-02,-5.55028168e-02,-5.92109910e-03,-1.24511765e-02, 9.41906293e-02, \
  2.27909815e-02, 1.87656902e-04,-9.12035237e-03,-1.62467444e-02, 6.53975432e-02, 1.16805283e-01, 1.71053299e-01, 1.79979657e-01, \
  1.08001562e-01, 1.16067532e-01, 1.26764868e-01, 1.36994995e-01, 1.94126925e-01, 2.30159335e-01, 1.66123946e-01,-2.53003130e-02, \
 -1.63386189e-01,-2.26404850e-02, 2.68044668e-01,-6.11721969e-02,-2.01202243e-01, 2.86861338e-01,-2.62577552e-01, 1.91316576e-01, \
 -1.69854376e-01, 1.52631309e-01,-2.17737552e-01, 3.10144962e-01,-3.29143295e-01, 2.18885407e-01,-1.44743503e-01,-3.38656382e-01, \
  6.15680277e-02, 3.37041044e-01,-5.05661979e-02,-3.64623658e-01,-2.11671324e-01, 1.29588555e-01, 3.54664024e-01, 3.53801633e-01, \
  2.03480813e-01,-5.96668208e-02, 3.90970857e-01,-1.31095023e-01,-2.16361596e-01,-2.35210363e-01,-1.89355430e-01,-5.73606645e-02, \
  1.39410651e-01, 3.55571038e-01, 3.85974835e-01, 4.12115551e-01, 1.87399880e-01,-3.00017074e-01,-4.44116245e-01,-2.89291715e-01, \
  2.09431852e-01, 4.51064041e-01, 2.44277232e-01, 4.28041099e-01, 4.21399855e-01, 1.42027194e-01,-2.11577705e-01,-4.58573270e-01, \
  2.12016138e-01, 4.22479925e-01,-2.92376603e-01,-3.40227074e-01, 4.85567522e-01,-5.11849105e-02,-4.82549097e-01, 3.99548130e-01, \
  2.33824827e-01, 3.11405650e-01, 4.88339782e-01,-6.44709662e-02,-4.45271793e-01, 4.95443752e-01,-4.42170248e-01, 1.32184830e-01, \
  3.82405071e-01,-5.19814894e-01, 4.08079191e-01,-3.47692305e-01,-3.37418486e-01, 4.76023294e-01,-5.39411589e-01, 5.42032144e-01, \
 -1.17333356e-01, 2.56690863e-01,-4.47777196e-01, 4.80841658e-01,-5.54976623e-01, 5.58443384e-01,-2.62070522e-01, 7.86469035e-02, \
  2.20666787e-01,-5.58207869e-01, 5.19196801e-01,-7.71705302e-02, 4.55461139e-01, 1.22176472e-01,-5.51538580e-01, 5.38195050e-01, \
 -8.73504099e-02, 2.85537960e-01, 3.33909562e-01, 3.20953898e-01, 5.83042033e-01,-3.53289078e-01,-3.87760803e-01, 5.48841408e-01, \
 -2.53663131e-01, 5.79632439e-01,-3.17872913e-01,-5.73249692e-01, 4.26543187e-01, 3.85191670e-01, 0.00000000e+00, 0.00000000e+00]])
for temp in varlist:
    act = varlist[temp][0][0:125]
    cal = data[temp][0][0:125]
    s   = str(0)
    perct = 100*sum(abs((act-cal)/act))
    print('  '+temp+'['+s+',:]: '+str(cal[64])+'   '+str(act[64])+'   '+str(int(perct))+'%')
    if perct > failtol:
        lfail = 1
    act = varlist[temp][1][0:125]
    cal = data[temp][1][0:125]
    s   = str(1)
    perct = 100*sum(abs((act-cal)/act))
    print('  '+temp+'['+s+',:]: '+str(cal[64])+'   '+str(act[64])+'   '+str(int(perct))+'%')
    if perct > failtol:
        lfail = 1
    act = varlist[temp][2][0:125]
    cal = data[temp][100][0:125]
    s   = str(100)
    perct = 100*sum(abs((act-cal)/act))
    print('  '+temp+'['+s+',:]: '+str(cal[64])+'   '+str(act[64])+'   '+str(int(perct))+'%')
    if perct > failtol:
        lfail = 1
    act = varlist[temp][3][0:125]
    cal = data[temp][1000][0:125]
    s   = str(1000)
    perct = 100*sum(abs((act-cal)/act))
    print('  '+temp+'['+s+',:]: '+str(cal[64])+'   '+str(act[64])+'   '+str(int(perct))+'%')
    if perct > failtol:
        lfail = 1
    act = varlist[temp][4][0:125]
    cal = data[temp][10000][0:125]
    s   = str(10000)
    perct = 100*sum(abs((act-cal)/act))
    print('  '+temp+'['+s+',:]: '+str(cal[64])+'   '+str(act[64])+'   '+str(int(perct))+'%')
    if perct > failtol:
        lfail = 1
    act = varlist[temp][5][0:125]
    cal = data[temp][20000][0:125]
    s   = str(20000)
    perct = 100*sum(abs((act-cal)/act))
    print('  '+temp+'['+s+',:]: '+str(cal[64])+'   '+str(act[64])+'   '+str(int(perct))+'%')
    if perct > failtol:
        lfail = 1
print('=================')

if (lfail):
    print('  STATUS: FAIL!!!!!')
else:
    print('  STATUS: PASS')

sys.exit(0)
