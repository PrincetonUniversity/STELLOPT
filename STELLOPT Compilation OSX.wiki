=STELLOPT Compilation on OS X= 

This page details how to compile the STELLOPT family of codes on OS X. In order to do so you will need to install [[@http://gcc.gnu.org/|GNU based compilers]] on your Apple machine and a package manager (such as MacPorts).
----
Installation Steps
# Download and install [[@https://developer.apple.com/xcode/|X Code]] for your version of OS X.
# Download and install [[@https://www.macports.org/|MacPorts]]. Please note we're assuming you'll be using the default location for installation of the various ports. If not you'll need to change the path to the variable MACPORTS in the setup script (and rezip).
# Use MacPorts to install your packages. For this example we're using gfortran 4.9 but you may substitute any other version. I've also chosen OpenMPI but the sources could also be built with MPICH.
{{{gcc7 version

sudo port install gcc7
sudo port install openmpi
sudo port install hdf5 +fortran +gcc7 +hl +openmpi
sudo port install netcdf +gcc7 +openmpi 
sudo port install netcdf-fortran +gcc7 +openmpi
sudo port install pgplot 
sudo port install OpenBLAS +gcc7 -gcc6 
sudo port install scalapack +gcc7 +openmpi +openblas
sudo port install ncarg +gcc7
# The following are needed for COILOPT++
sudo port install silo +gcc7
sudo port install gsl +gcc7 +optimize
# The following is for Python support
sudo port install python35 +gcc7
sudo port install py35-pyqt4 +gcc7
sudo port install py35-matplotlib +dvipng +pyside +qt4 +gcc7
# The following are needed for GENE
sudo port install fftw-3 +gcc7 +openmpi
sudo port install petsc +gcc7 +openmpi +openblas -accelerate +metis +mumps +parmetis +suitesparse +superlu_dist +complex
sudo port install slepc +gcc7 +openmpi +openblas +arpack -accelerate
}}}

{{{gcc8 version
Tested on: 
MacBook Pro (Retina, 15-inch, Mid 2015), 2.5 GHz Intel Core i7, 16 GB 1600 MHz DDR3
AMD Radeon R9 M370X 2048 MG Intel Iris Pro 1536 MB
macOS Mojave, Version 10.14.2

MacPorts-2.5.4-10.14-Mojave 17-35-43-409.pkg

sudo port install gcc8
sudo port install openmpi
sudo port install hdf5 +fortran +gcc8 +hl +openmpi
  (also asks for openmpi-gcc8. say yes.)
 sudo port select --set mpi openmpi-gcc8-fortran
sudo port install netcdf +gcc8 +openmpi 
sudo port install netcdf-fortran +gcc8 +openmpi
sudo port install pgplot 
   (C bindings broken in gcc8)
sudo port install OpenBLAS +gcc8 
sudo port install scalapack +gcc8 +openmpi +openblas

}}}


# Now the NCARG package broken as of this writing but there's a workaround. Download the tarball from the [[@http://www.ncarg.ucar.edu/|NCAR website]] the place the tarball in the appropriate location ([[@https://trac.macports.org/ticket/42541|see ticket #43615]]). Then rerun the port install command for ncarg.
# Now create a directory in which you wish to compile STELLOPT and place the STELLOPT ZIP file in that directory. Then unzip it.
# You'll need to install the [[@http://w3.pppl.gov/ntcc/PREACT/|PREACT library]] if you wish to use the BEAMS3D code. Create a new directory call NTCC and download the PREACT tarball into it. Then run the following commands (you need to make sure you have a v2 of Python loaded not v3)
{{{
mkdir NTCC
cd NTCC
cp ~/Downloads/preact.tar.gz .
tar -xf preact.tar.gz
make FORTRAN_VARIANT=GCC
}}}
# Unzip stellinstall
# Now you should be able to run the setup script and compile the STELLOPT family of codes.

If you run into problems regarding HDF5 or NetCDF durring compilation please verify that you've loaded the proper groups in MacPorts. This is accomplished by typing
{{{
>sudo port select --summary
Name    Selected               Options
====    ========               =======
db      none                   db48 none
gcc     mp-gcc49               dragonegg-3.3-gcc48 mp-gcc48 mp-gcc49 none
llvm    none                   mp-llvm-3.3 mp-llvm-3.5 none
mpi     openmpi-gcc49-fortran  mpich-mp-fortran openmpi-gcc49-fortran openmpi-mp-fortran none
python  none                   python25-apple python26-apple python27 python27-apple none
}}}
The important part is that the GCC and MPI groups are selected properly.